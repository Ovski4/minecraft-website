<?php

namespace Studmine\StatsBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * PlayerKillRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PlayerKillRepository extends EntityRepository
{
    /**
     * Get the "number of kill for a given killer and a given killed" queryBuilder
     *
     * @return integer
     */
    public function countKillsByPlayerQueryBuilder($player_killed_id, $player_killer_id)
    {
        $qb = $this->getEntityManager()->createQueryBuilder('pk');
        $qb->select('COUNT(pk)')
           ->from('StudmineStatsBundle:PlayerKill', 'pk')
           ->Where('pk.player_killed = :player_killed_id')
           ->setParameter('player_killed_id', $player_killed_id)
           ->andWhere('pk.player_killer = :player_killer_id')
           ->setParameter('player_killer_id', $player_killer_id)
        ;

        return $qb;
    }

    /**
     * Get the "number of kill for a given killer and a given killed" query
     *
     * @return DoctrineQuery
     */
    public function countKillsByPlayerQuery($player_killed_id, $player_killer_id)
    {
        $qb = $this->countKillsByPlayerQueryBuilder($player_killed_id, $player_killer_id);

        return is_null($qb) ? $qb : $qb->getQuery();
    }

    /**
     * Get the number of kill for a given killer and a given killed
     *
     * @return integer
     */
    public function countKillsByPlayer($player_killed_id, $player_killer_id)
    {
        $q = $this->countKillsByPlayerQuery($player_killed_id, $player_killer_id);

        return is_null($q) ? array() : $q->getSingleResult();
    }

}
